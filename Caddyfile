# Caddy configuration for reverse proxy and static file serving

# This block handles requests coming from the Tor hidden service (internal port 80)
# It reverse proxies to the target website.
:80 {
    # Reverse proxy to the specified website
    reverse_proxy https://2305878273.7844380499.cfd {
        # Pass original Host header to the backend
        header_up Host {http.request.host}
        # Pass client's real IP address
        header_up X-Forwarded-For {http.request.remote}
        header_up X-Real-IP {http.request.remote.host}
    }
}

# This block handles requests on port 443 for the keep-alive HTML page
# Caddy will automatically handle HTTPS for this if a domain is provided,
# but for a simple IP-based exposure, it will serve plain HTTP or require manual certs.
# For this example, it will serve the HTML page on port 443.
:443 {
    # Serve files from the /usr/share/caddy/html directory
    root * /usr/share/caddy/html
    file_server
}
